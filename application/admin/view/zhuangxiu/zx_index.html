{include file="common/all" /}
<style>
    /*分页*/
    .pagination {margin-left: 8.5rem;}
    .pagination li {display: inline-block;margin-right: -1px;padding: 13px;border: 1px solid #e2e2e2;min-width: 20px;text-align: center;width: 100px;height: 50px;}
    .pagination li.active {background: #009688;color: #fff;border: 1px solid #009688;}
    .pagination li a {display: block;text-align: center;}
</style>
<style type="text/css">
    #feedback,#feedback2{
        min-height: 200px;
        text-align: center;
        border: 1px solid silver;
        border-radius: 3px;
    }
    #feedback img,#feedback2 img,feedback_data img{
        margin:3px 10px;
        border: 1px solid silver;
        border-radius:3px;
        padding: 6px;
        width: 35%;
        height: 85%;
    }

    #feedback p,#feedback2 p{
        font-family: "微软雅黑";
        line-height: 120px;
        color: #ccc;
    }
    .file {
        position: relative;
        display: inline-block;
        border: 1px solid #1ab294;
        border-radius: 4px;
        padding: 8px 16px;
        overflow: hidden;
        color: #fff;
        text-decoration: none;
        text-indent: 0;
        line-height: 20px;
        color: #1ab294;
    }

    .file input {
        position: absolute;
        font-size: 100px;
        right: 0;
        top: 0;
        opacity: 0;
    }
    .box{
        margin-top: 10px;
    }
    .box a{
        margin-left: 10px;
    }

    #feedback,#feedback2{
        display: inline-block;
    }

    .liebiao{
        width: 50%;
        float: left;
    }
    .liebiao_data{width: 100%;margin-top: 20px;}
    .liebiao img{
        width: 32%;
        margin-bottom: 20px;
    }
</style>
<div class="main-panel">
    <!-- BEGIN : Main Content-->
    <div class="main-content">
        <div class="content-wrapper"><!--Extended Table starts-->
            <section id="extended">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="card">
                            <div class="card-header" style="width: 98%;margin: 0 auto;">
                                <form action="" role="search" class="navbar-form navbar mt-1" style="float: left !important;display: block" name="form1" id="form1">

                                    <!--轮播图 begin-->
<!--                                    <div class="form-group row" style="display: block;">-->
<!--                                        <label class="col-md-3 label-control redcolor" for="inputfile" style="max-width: 300px;">轮播图【尺寸：700X280】</label>-->
<!--                                        <div class="col-md-9" style="max-width: none;">-->
<!--                                            &lt;!&ndash; 响应返回数据容器 &ndash;&gt;-->
<!--                                            <div id="feedback">-->
<!--                                                {volist name="lunbotu" id="vo" <div class='volistno'>暂时没有数据<div>}-->
<!--                                                    {if condition="$vo"}-->
<!--                                                    <div class="liebiao shanchudiv{$key}">-->
<!--                                                        <img src="{$vo}">-->
<!--                                                        <input type="text" value="{$vo}" name="strinput" />-->
<!--                                                        <span onclick="shanchu({$key})">删除</span>-->
<!--                                                    </div>-->
<!--                                                    {/if}-->
<!--                                                {/volist}-->
<!--                                            </div>-->
<!--                                            <div class="box" style="min-width: 300px;">-->
<!--                                                <a href="javascript:;" class="file" style="margin-left:0;">选择图片-->
<!--                                                    <input type="file" multiple id="inputfile" name="" class="photo" style="width: 94px;height: 38px;">-->
<!--                                                </a>-->
<!--                                                <a href="javascript:;" class="file close1">清空重选-->
<!--                                                    <input type="buttom" class="photo">-->
<!--                                                </a>-->
<!--                                                <div style="width:10rem;margin:0 auto;">-->
<!--                                                    <button type="button" class="btn btn-raised btn-primary add" style="width:9rem">-->
<!--                                                        <i class="fa fa-check-square-o"></i>提交-->
<!--                                                    </button>-->
<!--                                                </div>-->
<!--                                            </div>-->

<!--                                         </div>-->
<!--                                    </div>-->
                                    <!--轮播图 end-->


                                    <!--轮播图 begin-->
                                            <div class="form-group row" style="display: block;">
                                                <label class="col-md-3 label-control redcolor" for="inputfile_data" style="max-width: 300px;">轮播图【尺寸：700X280】</label>
                                                <div class="col-md-9" style="max-width: none;">
                                                    <!-- 响应返回数据容器 -->
                                                    <div id="feedback_data" style="width: 100%;min-height: 200px;text-align: center;border: 1px solid silver;border-radius: 3px;display: inline-block;">
                                                        {volist name="get_index_banner_data" id="vo" <div class='volistno'>暂时没有数据<div>}
                                                            {if condition="$vo"}
                                                                <div class="liebiao liebiao_data shanchudiv_data{$key}">
                                                                    <img src="{$vo.img}">
                                                                    <input type="text" value="{$vo.img}" name="strinput_data" />
                                                                    <input type="text" value="{$vo.url}" name="strinput_url" />
                                                                    <span onclick="shanchu_data({$key})">删除</span>
                                                                </div>
                                                            {/if}
                                                        {/volist}
                                                    </div>
                                                        <div class="box" style="min-width: 300px;">
                                                            <a href="javascript:;" class="file" style="margin-left:0;">选择图片
                                                                <input type="file" multiple id="inputfile_data" name="" class="photo_data" style="width: 94px;height: 38px;">
                                                            </a>
                                                            <a href="javascript:;" class="file close1_data">清空重选
                                                                <input type="buttom" class="photo_data">
                                                            </a>
                                                            <div style="width:10rem;margin:0 auto;">
                                                                <button type="button" class="btn btn-raised btn-primary add_data" style="width:9rem">
                                                                    <i class="fa fa-check-square-o"></i>提交
                                                                </button>
                                                            </div>
                                                        </div>

                                                    </div>
                                            </div>
                                    <!--轮播图 end-->




                                </form>



                            </div>

                        </div>
                    </div>
                </div>
            </section>
            <!--Extended Table Ends-->
        </div>
    </div>
    <!-- END : End Main Content-->
</div>
</div>

{include file="common/right" /}


<!-- BEGIN VENDOR JS-->
<script src="http://img.lll1.vip/apex-assets/vendors/js/core/jquery-3.2.1.min.js" type="text/javascript"></script>
<script src="http://img.lll1.vip/apex-assets/vendors/js/core/popper.min.js" type="text/javascript"></script>
<script src="http://img.lll1.vip/apex-assets/vendors/js/core/bootstrap.min.js" type="text/javascript"></script>
<script src="http://img.lll1.vip/apex-assets/vendors/js/perfect-scrollbar.jquery.min.js" type="text/javascript"></script>
<script src="http://img.lll1.vip/apex-assets/vendors/js/prism.min.js" type="text/javascript"></script>
<script src="http://img.lll1.vip/apex-assets/vendors/js/jquery.matchHeight-min.js" type="text/javascript"></script>
<script src="http://img.lll1.vip/apex-assets/vendors/js/screenfull.min.js" type="text/javascript"></script>
<script src="http://img.lll1.vip/apex-assets/vendors/js/pace/pace.min.js" type="text/javascript"></script>
<!-- BEGIN VENDOR JS-->
<!-- BEGIN PAGE VENDOR JS-->
<!-- END PAGE VENDOR JS-->
<!-- BEGIN APEX JS-->
<script src="http://img.lll1.vip/apex-assets/js/app-sidebar.js" type="text/javascript"></script>
<script src="http://img.lll1.vip/apex-assets/js/notification-sidebar.js" type="text/javascript"></script>
<script src="http://img.lll1.vip/apex-assets/js/customizer.js" type="text/javascript"></script>
<script src="http://img.lll1.vip/qrcode.js" type="text/javascript"></script>
<!-- END APEX JS-->
<!-- BEGIN PAGE LEVEL JS-->
<!-- END PAGE LEVEL JS-->
<script type="text/javascript">
    $(document).ready(function(){
        //响应文件添加成功事件
        var feedback = $("#feedback");
        $("#inputfile").change(function(){
            if (this.files.length>6) {
                alert("最多只能选择6张图片");
                return false;
            }
            //创建FormData对象
            var data = new FormData();
            //为FormData对象添加数据
            $.each($('#inputfile')[0].files, function(i, file) {
                data.append('ruoshui'+i, file);
            });
            //追加其他数据
            data.append('id',1);
            //发送数据

            $.ajax({
                type : 'post',
                url : '/sun_admin/shopgoods_pho_ali_upl', //接口
                data : data,
                cache : false,
                processData : false, // 不处理发送的数据，因为data值是Formdata对象，不需要对数据做处理
                contentType : false, // 不设置Content-type请求头
                success : function(data){
                    console.log(data.datas);
                    if(data.status == 200){

                        var str = '';
                        var strinput = '';

                        $.each(data.datas,function(i,n){
                            str +='<div class="liebiao"><img src="'+n+'">';
                            str +='<input type="text" value="'+n+'" name="strinput" />';
                            str += '<span> 新的</span></div>';
                        });
                        $("#feedback").append(str);
                        // $("#feedback").append(strinput);
                    }else {
                        alert(data.msg);
                        return false;
                    }
                },
                error : function(){ alert('上传出错'); }
            });

        });
        $(".close1").on("click",function(){
            $("#feedback").empty();
        });
    });
</script>

<script type="text/javascript">
    $(document).ready(function(){
        //响应文件添加成功事件
        var feedback = $("#feedback2");
        $("#inputfile2").change(function(){
            if (this.files.length>12) {
                alert("最多只能选择12张图片");
                return false;
            }
            //创建FormData对象
            var data = new FormData();
            //为FormData对象添加数据
            $.each($('#inputfile2')[0].files, function(i, file) {
                data.append('ruoshui'+i, file);
            });
            //追加其他数据
            data.append('id',1);
            //发送数据

            $.ajax({
                type : 'post',
                url : '/yiwang/shopgoods_pho_upl', //接口
                data : data,
                cache : false,
                processData : false, // 不处理发送的数据，因为data值是Formdata对象，不需要对数据做处理
                contentType : false, // 不设置Content-type请求头
                success : function(data){
                    console.log(data.datas);
                    if(data.status == 200){

                        var str = '';
                        var strinput = '';

                        $.each(data.datas,function(i,n){
                            str +='<div class="liebiao"><img src="'+n+'">';
                            strinput +='<input type="text" value="'+n+'" name="strinput2" /></div>';
                        });
                        $("#feedback2").append(str);
                        $("#feedback2").append(strinput);
                    }else {
                        alert(data.msg);
                        return false;
                    }
                },
                error : function(){ alert('上传出错'); }
            });

        });
        $(".close2").on("click",function(){
            $("#feedback2").empty();
        });
    });
</script>

<script>

    //轮播图
    $(".add").click(function(){
        var arr =[];
        $("input[name='strinput']").each(function(){
            arr.push($(this).val());
        })
        var lunbotu = arr;

        if(lunbotu == ''){
            swal(
                '轮播图不能为空',
                '',
                'error'
            );
        }

        $.ajax({
            type: 'post',
            url: '/sun_admin/zx_lbt_sub',
            dataType: 'json',
            data: {
                lunbotu:lunbotu,
            },
            success: function(res){
                if(res.status == '200')
                {
                    swal(
                        res.msg,
                        '',
                        'success'
                    );

                    window.location.reload()
                    // var index = parent.layer.getFrameIndex(window.name);
                    // setTimeout(function(){parent.layer.close(index);},1800);

                }else{
                    swal(
                        res.msg,
                        '',
                        'error'
                    )
                }
            },
        });

    })

    function shanchu(id){
        var sc = '.shanchudiv' + id;
        //console.log(sc);return false;
        $(sc).remove();
    }


    //上传图片 详情
    function upimgxq0(da,da33,obj){
        console.log(obj);

        if( obj.value == "" ) {
            return;
        }
        var formdata = new FormData();
        formdata.append("img" , $(obj)[0].files[0]);//获取文件法二

        $.ajax({
            type : 'post',
            url : '/sun_admin/shopgoods_img_upl', //接口
            data : formdata,
            cache : false,
            processData : false, // 不处理发送的数据，因为data值是Formdata对象，不需要对数据做处理
            contentType : false, // 不设置Content-type请求头
            success : function(response){
                console.log(response.datas);
                if(response.status == 200){

                    var imgsrcname = '#xiangqing_img0';//图片的src
                    var imgsrcurl = '#xiangqing0';//隐藏的input的图片链接
                    var imgsrcfile = '#xiangqing_file0';//上传图片的input

                    $(imgsrcname).attr('src',response.datas);//赋值到img的src
                    $(imgsrcname).css('display','block');//显示img
                    $(imgsrcurl).val(response.datas);//赋值到input的value
                    //$(imgsrcfile).css('display','none');//隐藏文件上传框

                }else {
                    swal(
                        response.msg,
                        '',
                        'error'
                    );
                }
            },
            error : function(){ }
        });
    }

    //提交导航
    $(".adddh1").click(function(){

        var zx_title0               =     $("#zx_title0").val();                                              
        var zx_value0               =     $("#xiangqing0").val();
        var zx_is_show0             =     $("#zx_is_show0").val();
     
        if(zx_title0 == '' || zx_value0 == ''){
            swal('参数为必填项请填写完整', '', 'error');
            return false;
        }
        if(name.zx_title0 >60 ){
            swal('标题太长', '', 'error');
            return false;
        }

        //$("#form1").submit();
        $.ajax({
            type: 'post',
            url: '/sun_admin/zx_index_lbt_sub',
            dataType: 'json',
            data: {
                zx_title0:zx_title0,
                zx_value0:zx_value0,
                zx_is_show0:zx_is_show0,
            },
            success: function(res){
                if(res.status == '200')
                {
                    swal(
                        res.msg,
                        '',
                        'success'
                    );

                }else{
                    swal(
                        res.msg,
                        '',
                        'error'
                    )
                }
            },
        });
    })

    //商家主页轮播图
    $(".add2").click(function(){
        var arr =[];
        $("input[name='strinput2']").each(function(){
            arr.push($(this).val());
        })
        var lunbotu = arr;

        if(lunbotu == ''){
            swal(
                '轮播图不能为空',
                '',
                'error'
            );
        }

        $.ajax({
            type: 'post',
            url: '/sun_admin/zx_sj_lbt_sub',
            dataType: 'json',
            data: {
                lunbotu:lunbotu,
            },
            success: function(res){
                if(res.status == '200')
                {
                    swal(
                        res.msg,
                        '',
                        'success'
                    );

                    window.location.reload()
                    // var index = parent.layer.getFrameIndex(window.name);
                    // setTimeout(function(){parent.layer.close(index);},1800);

                }else{
                    swal(
                        res.msg,
                        '',
                        'error'
                    )
                }
            },
        });

    })

</script>

<!--第二个-->
<script type="text/javascript">
    $(document).ready(function(){
        //响应文件添加成功事件
        var feedback = $("#feedback_data");
        $("#inputfile_data").change(function(){
            if (this.files.length>6) {
                alert("最多只能选择6张图片");
                return false;
            }
            //创建FormData对象
            var data = new FormData();
            //为FormData对象添加数据
            $.each($('#inputfile_data')[0].files, function(i, file) {
                data.append('ruoshui'+i, file);
            });
            //追加其他数据
            data.append('id',1);
            //发送数据

            $.ajax({
                type : 'post',
                url : '/sun_admin/shopgoods_pho_ali_upl', //接口
                data : data,
                cache : false,
                processData : false, // 不处理发送的数据，因为data值是Formdata对象，不需要对数据做处理
                contentType : false, // 不设置Content-type请求头
                success : function(data){
                    console.log(data.datas);
                    if(data.status == 200){

                        var str = '';
                        var strinput = '';

                        $.each(data.datas,function(i,n){
                            str +='<div class="liebiao liebiao_data"><img src="'+n+'">';
                            str +='<input type="text" value="'+n+'" name="strinput_data" />';
                            str +='<input type="text" value="" name="strinput_url" />';
                            str += '<span> 新的</span></div>';
                        });
                        $("#feedback_data").append(str);
                        // $("#feedback").append(strinput);
                    }else {
                        alert(data.msg);
                        return false;
                    }
                },
                error : function(){ alert('上传出错'); }
            });

        });
        $(".close1_data").on("click",function(){
            $("#feedback_data").empty();
        });
        $(".add_data").click(function(){
            var arr =[];
            $("input[name='strinput_data']").each(function(){
                arr.push($(this).val());
            })
            var lunbotu = arr;

            var arr_url =[];
            $("input[name='strinput_url']").each(function(){
                arr_url.push($(this).val());
            })
            var url = arr_url;

            if(lunbotu == ''){
                swal(
                    '轮播图不能为空',
                    '',
                    'error'
                );
            }

            $.ajax({
                type: 'post',
                url: '/sun_admin/zx_lbt_sub_data',
                dataType: 'json',
                data: {
                    lunbotu:lunbotu,
                    url:url,
                },
                success: function(res){
                    if(res.status == '200')
                    {
                        swal(
                            res.msg,
                            '',
                            'success'
                        );

                        window.location.reload()
                        // var index = parent.layer.getFrameIndex(window.name);
                        // setTimeout(function(){parent.layer.close(index);},1800);

                    }else{
                        swal(
                            res.msg,
                            '',
                            'error'
                        )
                    }
                },
            });

        })
    });
    function shanchu_data(id){
        var sc = '.shanchudiv_data' + id;
        //console.log(sc);return false;
        $(sc).remove();
    }
</script>

</body>
<!-- END : Body-->
</html>